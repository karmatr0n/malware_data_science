import pefile
import os

class PEUtil(object):
  def pe_files(self, target_path):
    pe_files = []
    for root, _dirs, files in os.walk(target_path):
      for sample_path in files:
        try:
          pefile.PE(os.path.join(root, sample_path))
        except pefile.PEFormatError:
          continue
        pe_files.append(os.path.join(root, sample_path))
    return pe_files
